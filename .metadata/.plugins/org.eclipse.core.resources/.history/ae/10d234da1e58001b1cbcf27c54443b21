$(function(){
	var elements = document.getElementsByClassName("elements");
	// 모든 영역 접기
	for (var i = 0; i < elements.length; i++) {
	    elements[i].style.display="none";
	}
	$('.label').click(function(){
		switchDisplay(this.id.replace(/[^0-9]/g, ""));
	});	
	
	//상위 카테고리 클릭 이벤트
	$('.topCategory').click(function(){
		getSubCategory(this.id.replace(/[^0-9]/g, ""));
	});
	
	//하위 카테고리 클릭 이벤트
	$('.subCategory').click(function(){
		getSubLecture(this.id.replace(/[^0-9]/g, ""), $('#topcategory_id').val());
	});
	
	//수강 등록 클릭 이벤트
	$('#courseRegist').click(function(){
		console.log($('#member_id').val());
		console.log($('#lecture_id').val());
		courseRegist($('#member_id').val(),$('#lecture_id').val());
	});
	$('#registIdNull').click(function(){
		alert('로그인이 필요한 서비스 입니다.');
		location.href='/loginForm';
	});
});

//상위 카테고리를 선택하면 하위 카테고리를 db에서 가져옴.
function getSubCategory(id) {
	location.href = "/course/list?topcategory_id=" + id;
}

//하위 카테고리를 선택하면 하위카테고리에 소속된 강의를  db에서 가져온다.
function getSubLecture(subid, topid) {
	location.href = "/course/listSub?topcategory_id=" + topid + "&subcategory_id=" + subid;
}

function switchDisplay(id) {
	var target = document.querySelector("#section_detail"+id);
	
	if (target.style.display == "none") {
	  target.style.display="block";
	} else {
	  target.style.display="none";
	}
	return false;
}

function courseRegist(member_id, lecture_id){
	$.ajax({
		url: "/course/regist?member_id="+member_id+"&lecture_id="+lecture_id,
		type: "GET",
		success : function(data){
			console.log('성공');
		},
		error : function(){
			console.log('실패');
		}
	});
}